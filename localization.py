messages = {
    "welcome": {
        "ru": "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üëã",
        "uz": "Xush kelibsiz! üëã"
    },
    "share_phone": {
        "ru": "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º –Ω–æ–º–µ—Ä–æ–º –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤:",
        "uz": "Iltimos, buyurtma uchun telefon raqamingizni ulashing:"
    },
    "phone_saved": {
        "ru": "–°–ø–∞—Å–∏–±–æ! –ù–æ–º–µ—Ä —Å–æ—Ö—Ä–∞–Ω—ë–Ω. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π —Ä–∞–∑–¥–µ–ª –º–µ–Ω—é üëá",
        "uz": "Rahmat! Raqamingiz saqlandi. Kerakli bo‚Äòlimni tanlang üëá"
    },
    "share_button": {
        "ru": "üì± –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –Ω–æ–º–µ—Ä–æ–º",
        "uz": "üì± Telefon raqamimni ulashish"
    },
    "empty_cart": {
        "ru": "",
        "uz": ""
    },
    "branches": {
        "ru": {
            "title": "–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–ª–∏–∞–ª:",
            "options": [
                ("üìç –ö–∏—Ä–≥–∏–ª–∏-–ê–¢–°, –ö–æ–∫–∞–Ω–¥—Å–∫–∞—è —É–ª–∏—Ü–∞, 97", "branch_1"),
                ("üìç –ö–∏—Ä–≥–∏–ª–∏-–î—Ä—É–∂–±–∞, –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω—Å–∫–∞—è —É–ª–∏—Ü–∞, 17", "branch_2"),
                ("üìç –ö–∏—Ä–≥–∏–ª–∏-–®–∏—Ä–æ—Ç–∫–∞, –£–∑–±–µ–∫–∏—Å—Ç–∞–Ω—Å–∫–∞—è —É–ª–∏—Ü–∞, 17", "branch_3"),
                ("üìç –§–µ—Ä–≥–∞–Ω–∞-–ú–∞—Ç–∞–ª–∫–∞, —É–ª–∏—Ü–∞ –ë—É—Ä—Ö–æ–Ω–∏–¥–¥–∏–Ω–∞ –ê–ª—å-–ú–∞—Ä–≥–∏–Ω–æ–Ω–∏, 60", "branch_4"),
                ("üìç –§–µ—Ä–≥–∞–Ω–∞-–ö–∞–ª–∏–Ω–∫–∞, —É–ª–∏—Ü–∞ –ê—Ö–º–∞–¥–∞ –Ø—Å—Å–∞–≤–∏, 30", "branch_5"),
                ("üìç –§–µ—Ä–≥–∞–Ω–∞-Asia.uz, —É–ª–∏—Ü–∞ –ú—É—Å—Ç–∞–∫–∏–ª–ª–∏–∫, 13", "branch_6")
            ]
        },
        "uz": {
            "title": "Filialni tanlang:",
            "options": [
                ("üìç Kirguli-ATS, Quqon ko'chasi, 97", "branch_1"),
                ("üìç Kigruli-Drujba, O'zbekiston ko'chasi, 17", "branch_2"),
                ("üìç Kirguli-Shrotka, O'zbekiston ko'chasi, 17", "branch_3"),
                ("üìç Farg'ona-Matalka, Burhoniddin Al-Marginoniy ko'chasi, 60", "branch_4"),
                ("üìç Farg'ona-Kalinka, Axmad Yassaviy ko'chasi, 30", "branch_5"),
                ("üìç Farg'ona-Asia.uz, Mustaqillik ko'chasi, 13", "branch_6")
            ]
        }
    },
    "menu": {
        "welcome": {
            "ru": "–î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å! üëã",
            "uz": "Xush kelibsiz! üëã"
        },
        "share_phone": {
            "ru": "üì± –ü–æ–¥–µ–ª–∏—Ç—å—Å—è –Ω–æ–º–µ—Ä–æ–º",
            "uz": "üì± Telefon raqamimni ulashish"
        },
        "request_phone": {
            "ru": "–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º –Ω–æ–º–µ—Ä–æ–º –¥–ª—è –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏—è –∑–∞–∫–∞–∑–æ–≤:",
            "uz": "Iltimos, buyurtma uchun telefon raqamingizni ulashing:"
        },
        "phone_saved": {
            "ru": "–°–ø–∞—Å–∏–±–æ! –ù–æ–º–µ—Ä —Å–æ—Ö—Ä–∞–Ω—ë–Ω. –í—ã–±–µ—Ä–∏—Ç–µ –Ω—É–∂–Ω—ã–π —Ä–∞–∑–¥–µ–ª –º–µ–Ω—é üëá",
            "uz": "Rahmat! Raqamingiz saqlandi. Kerakli bo‚Äòlimni tanlang üëá"
        }
    },
    "cart": {
        "no_address": {
            "ru": "–ê–¥—Ä–µ—Å –Ω–µ —É–∫–∞–∑–∞–Ω",
            "uz": "Manzil ko ªrsatilmagan"
        },
        "address": {
            "ru": "–ê–¥—Ä–µ—Å",
            "uz": "Manzil"
        },
        "request_location": {
            "ru": "üìç –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ—Ç–ø—Ä–∞–≤—å—Ç–µ –≤–∞—à—É –≥–µ–æ–ø–æ–∑–∏—Ü–∏—é –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∑–∞–∫–∞–∑–∞.",
            "uz": "üìç Iltimos, buyurtmani yakunlash uchun joylashuvingizni yuboring."
        },
        "location_saved": {
            "ru": "‚úÖ –õ–æ–∫–∞—Ü–∏—è –ø–æ–ª—É—á–µ–Ω–∞. –û—Ñ–æ—Ä–º–ª—è–µ–º –≤–∞—à –∑–∞–∫–∞–∑...",
            "uz": "‚úÖ Joylashuv qabul qilindi. Buyurtmangiz rasmiylashtirilmoqda..."
        },
        "branch": {
            "ru": "–§–∏–ª–∏–∞–ª",
            "uz": "Filial"
        },
        "choose_branch": {
            "ru": "–í—ã–±–µ—Ä–∏—Ç–µ —Ñ–∏–ª–∏–∞–ª",
            "uz": "Filialni tanlang"
        },
        "no_branch": {
            "ru": "–§–∏–ª–∏–∞–ª –Ω–µ –≤—ã–±—Ä–∞–Ω",
            "uz": "Filial tanlanmagan"
        },
        "enter_comment": {
            "ru": "–í–≤–µ–¥–∏—Ç–µ –≤–∞—à –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏ –∞–¥—Ä–µ—Å –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏:",
            "uz": "Izohingizni kiriting va manzilingizni:"
        },
        "comment_saved": {
            "ru": "‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏ –∞–¥—Ä–µ—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω",
            "uz": "‚úÖ Izoh va manzil saqlandi"
        },
        "your_cart": {
            "ru": "üõí–í–∞—à–∞ –∫–æ—Ä–∑–∏–Ω–∞",
            "uz": "üõí Sizning savatingiz"
        },
        "total": {
            "ru": "–ò—Ç–æ–≥–æ",
            "uz": "Jami"
        },
        "removed": {
            "ru": "–£–¥–∞–ª–µ–Ω",
            "uz": "Olib tashlandi"
        },
        "payment_cash_confirmed": {
            "ru": "üíµ –û–ø–ª–∞—Ç–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞.",
            "uz": "üíµ Olinganda to‚Äôlov tasdiqlandi."
        },
        "no_comment": {
            "ru": "–ù–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏—è –∫ –∑–∞–∫–∞–∑—É",
            "uz": "Hech qanday sharh yo ªq"
        },
        "no_phone": {
            "ru": "–ù–µ—Ç —Ç–µ–ª–µ—Ñ–æ–Ω–∞",
            "uz": "Telefon yo ªq"
        },
        "new_order": {
            "ru": "–ù–æ–≤—ã–π –∑–∞–∫–∞–∑",
            "uz": "Yangi buyurtma"
        },
        "phone": {
            "ru": "–¢–µ–ª–µ—Ñ–æ–Ω",
            "uz": "Telefon"
        },
        "comment": {
            "ru": "–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π",
            "uz": "Izoh"
        },
        "currency": {
            "ru": "—Å—É–º",
            "uz": "so'm"
        },
        "success_full": {
            "ru": "–ó–∞–∫–∞–∑ –æ—Ñ–æ—Ä–º–ª–µ–Ω",
            "uz": "Buyurtma rasmiylashtirildi"
        }
    },
    "buttons": {
        "menu": {
            "ru": "üçî –ú–µ–Ω—é",
            "uz": "üçî Menu"
        },
        "cart": {
            "ru": "üõí –ö–æ—Ä–∑–∏–Ω–∞",
            "uz": "üõí Savat"
        },
        "back": {
            "ru": "‚¨ÖÔ∏è –ù–∞–∑–∞–¥",
            "uz": "‚¨ÖÔ∏è Orqaga"
        },
        "add_comment": {
            "ru": "‚úÖ –î–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π –∏ –∞–¥—Ä–µ—Å –¥–ª—è –¥–æ—Å—Ç–∞–≤–∫–∏",
            "uz": "‚úÖ Izoh va manzil qo‚Äòshish"
        },
        "pay_online": {
            "ru": "‚úÖ –û–ø–ª–∞—Ç–∏—Ç—å –æ–Ω–ª–∞–π–Ω",
            "uz": "‚úÖ Onlayn to‚Äòlash"
        },
        "pay_cash": {
            "ru": "üíµ –û–ø–ª–∞—Ç–∞ –ø—Ä–∏ –ø–æ–ª—É—á–µ–Ω–∏–∏",
            "uz": "üíµ Qabul qilishda to‚Äòlash"
        }
    }

}

def get_message(key, lang):
    keys = key.split(".")
    msg = messages
    for k in keys:
        msg = msg.get(k, {})
    if isinstance(msg, dict):
        return msg.get(lang, list(msg.values())[0])  # default to first language if missing
    return msg

def get_branch_name(branch_id, lang):
    branches_data = messages.get("branches", {}).get(lang, {}).get("options", [])
    for name, callback in branches_data:
        if callback == branch_id:
            return name
    return branch_id  # –ï—Å–ª–∏ —Ñ–∏–ª–∏–∞–ª –Ω–µ –Ω–∞–π–¥–µ–Ω, –æ—Å—Ç–∞–≤–ª—è–µ–º ID